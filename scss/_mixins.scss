@use "variables" as *;

/* ===========================
   MIXINS
   =========================== */

/* -------- Media helpers -------- */

/* min-width за іменем брейка з $breakpoints */
@mixin media($key) {
  $val: map-get($breakpoints, $key);
  @if $val {
    @media (min-width: $val) { @content; }
  } @else {
    @warn "Breakpoint `#{$key}` не знайдено у $breakpoints.";
  }
}

/* max-width за конкретним значенням або ключем карти */
@function bp-get($x) {
  @if type-of($x) == 'string' {
    $val: map-get($breakpoints, $x);
    @if $val { @return $val; }
    @warn "Breakpoint `#{$x}` не знайдено у $breakpoints.";
    @return null;
  }
  @return $x;
}

@mixin media-max($to) {
  $max: bp-get($to);
  @if $max { @media (max-width: $max) { @content; } }
}

@mixin media-between($from, $to) {
  $min: bp-get($from);
  $max: bp-get($to);
  @if $min and $max {
    @media (min-width: $min) and (max-width: $max) { @content; }
  }
}

/* Точність, щоб уникати конфлікту рівно на брейку */
$bp-epsilon: 0.02px;

/* Діапазони під макет:
   - 320–<768
   - 768–1440
*/
@mixin bp-320-768 {
  @include media-between($bp-xs, ($bp-md - $bp-epsilon)) { @content; }
}
@mixin bp-768-1440 {
  @include media-between(md, 1440px) { @content; }
}

/* -------- Layout helpers -------- */

@mixin container($max: $container-max) {
  width: 100%;
  max-width: $max;
  margin-inline: auto;
  padding-inline: 16px;
}

/* Швидко проставити бічні падинги */
@mixin pad-inline($l, $r) {
  padding-left: $l;
  padding-right: $r;
}

/* -------- Accessibility -------- */

@mixin focus-ring($color: $brand-hover) {
  outline: 2px solid $color;
  outline-offset: 2px;
}

/* -------- Typography helpers -------- */

@mixin text(
  $size,
  $line: $line-height-base,
  $weight: $font-weight-regular,
  $color: inherit,
  $ls: normal,
  $family: $font-family-base
) {
  font-family: $family;
  font-size: $size;
  line-height: $line;
  font-weight: $weight;
  letter-spacing: $ls;
  color: $color;
}

/* Заголовки (за замовчуванням — акцентний шрифт) */
@mixin heading(
  $size,
  $line: 1.2,
  $weight: $font-weight-bold,
  $color: inherit,
  $ls: -0.01em,
  $family: $font-family-accent
) {
  @include text($size, $line, $weight, $color, $ls, $family);
}

/* Тіло тексту */
@mixin body-text(
  $size: $font-size-base,
  $line: $line-height-base,
  $color: inherit,
  $weight: $font-weight-regular
) {
  @include text($size, $line, $weight, $color);
}

/* Шорткати під наші дефолтні сімейства */
@mixin heading-default($size, $line: 1.2, $color: inherit) {
  @include heading($size, $line, $font-weight-bold, $color, -0.01em, $font-family-accent);
}
@mixin body-default($size: $font-size-base, $line: $line-height-base, $color: inherit) {
  @include body-text($size, $line, $color, $font-weight-regular);
}

/* -------- Buttons -------- */

@mixin button-base {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: $space-2;
  padding: 12px 18px;
  border-radius: 999px;
  border: 1px solid transparent;
  font-weight: 600;
  line-height: 1;
  cursor: pointer;
  text-decoration: none;
  transition:
    background-color .2s ease,
    color .2s ease,
    border-color .2s ease,
    box-shadow .2s ease;
}

@mixin button-solid(
  $bg:   $btn-bg-default,
  $fg:   $btn-fg-default,
  $bgH:  $btn-bg-hover,
  $bgA:  $btn-bg-pressed,
  $bgD:  $btn-bg-disabled,
  $fgD:  $btn-fg-disabled
) {
  @include button-base;
  background-color: $bg;
  color: $fg;

  &:hover   { background-color: $bgH; }
  &:active  { background-color: $bgA; }
  &:focus-visible { @include focus-ring($bgH); }

  &:disabled,
  &[aria-disabled="true"] {
    background-color: $bgD;
    color: $fgD;
    cursor: not-allowed;
  }
}

/* -------- Inputs -------- */

@mixin input-base {
  width: 100%;
  padding: 12px 14px;
  border-radius: $radius-12;
  border: 1px solid $input-border-default;
  background: $white;
  color: $input-text-default;
  transition: border-color .2s ease, box-shadow .2s ease;

  &::placeholder { color: $gray-3; }

  &:focus-visible {
    border-color: $input-border-focus;
    @include focus-ring($input-border-focus);
  }

  &[data-state="data"] {
    border-color: $input-border-data;
    color: $input-text-data;
  }

  &[aria-invalid="true"] {
    border-color: $input-border-error;
  }
}

/* -------- Misc -------- */

/* Фон з 10% непрозорістю будь-якого кольору */
@mixin bg-10($color) {
  background-color: rgba($color, 0.10);
}
